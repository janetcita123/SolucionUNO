<%

  event.id= event.id;     
    for (var i = 0; i < jsEventos.length; i++) {
        if(jsEventos[i].id==event.id){
            event.personas=jsEventos[i].personas;
        }

    }
 	event.date_start = (new Date(parseInt(event.start)));
	event.date_end = new Date(parseInt(event.end));
    event.title = event.title;
      event.rol = (event.rol).toString();
      event.creador = (event.creador).toString();
      event.creador = event.creador;
    event.detalle= event.detalle;
    event.hourini=event.date_start.getHours();
    event.minini=event.date_start.getMinutes();
    event.hourfin=event.date_end.getHours();
    event.minfin=event.date_end.getMinutes();    
    if (event.hourini < 10) { event.hourini='0'+event.hourini;}
    if (event.hourfin < 10) { event.hourfin='0'+event.hourini;}
    if (event.minini < 10) { event.minini='0'+event.minini;}
    if (event.minfin < 10) { event.minfin='0'+event.minfin;}
    event.agenda= event.agenda;
    event.areas= event.areas;
    event.entidades= event.entidades;
    event.personas= event.personas;
    event.estado = event.estado;

    var numerado2 = 9999999999;
    var tbl = '';
    var titulo='';
    var enumera=0;  
    
    ListarAcuerdos(event.estado, event.date_start, event.id); 

    
for (var i = 0; i < event.agenda.length; i++) {
    enumera=enumera+1
    titulo = event.agenda[i].tituloa ;
    descripcion = event.agenda[i].detallea;
    numerado2 = numerado2 + 1;
    var but = "<"; 
    but = but+"button id='"+ numerado2+"' class='btn-view-fund btn btn-default btn-xs verAgendaModal' type='button'>"+ "<";
    but = but + "span class='glyphicon glyphicon-list' aria-hidden='true'>" + "<" + "/span><"+"/button>";
    
    tbl=tbl+"<tr><td name='tdagenda' id='" + numerado2 + "' colspan='2' title='" + descripcion +"' style='text-align: left;'>"+enumera+'.- '+ titulo +
    "</td><td style='text-align: right;'>"+but
    tbl=tbl+"</td></tr>";
}
event.tabla=tbl;

var tblareas = '';
for (var i = 0; i < event.areas.length; i++) {
    titulo = event.areas[i].sigla ;
    descripcion = event.areas[i].descripcion;
 
    tblareas=tblareas+"<tr><td name='tarea' colspan='2' title='" + descripcion +"' style='text-align: left;'>Area "+ titulo +"</td><td style='text-align: right;'></td></tr>";
}
event.tblareas=tblareas;

var tblentidades = '';
for (var i = 0; i < event.entidades.length; i++) {
    titulo = event.entidades[i].sigla ;
    descripcion = event.entidades[i].descripcion;

    tblentidades=tblentidades+"<tr><td name='tentidad' colspan='2' title='" + descripcion +"' style='text-align: left;'>Entidad "+ titulo +"</td><td style='text-align: right;'></td></tr>";
}
event.tblentidades=tblentidades;

var tblpersonas = '';
enumera=0;
var inhabilita = '';
var asiste = '';
if (event.rol==1){inhabilita = 'disabled';}
if (event.creador==0){inhabilita = 'disabled';}
for (var i = 0; i < event.personas.length; i++) {
        
     
    enumera= enumera+1;
    titulo = enumera+'.- '+event.personas[i].nombres+' '+event.personas[i].apepat+' '+event.personas[i].apemat+' (' +event.personas[i].sigla+')' ;
    descripcion = event.personas[i].area;
    var dni =event.personas[i].dni;
    var iso = 'marcarAsistencia(this)';
    if (event.personas[i].asistencia){
    var checkbox1 = "<"+"td>"+"<"+"input type"+"='checkbox' class='asistencia' "+"title='Asistencia' name='asis' value='"+event.personas[i].dni+"'  checked "+inhabilita+" />"+"<"+"/td>";
    }else{
    var checkbox1 = "<"+"td>"+"<"+"input type"+"='checkbox' class='asistencia' "+"title='Asistencia' name='asis' value='"+event.personas[i].dni+"' "+inhabilita+" />"+"<"+"/td>";
     }
    var checkbox0 ="<td><input type='checkbox' title='Asistencia' name='asis' value='"+ event.personas[i].dni + "' onclick='marcarAsistencia(this)' /></td>"; 
    tblpersonas=tblpersonas+"<tr><td name='tpersona' colspan='2' title='" + descripcion +"' style='text-align: left;'>"+ titulo +"</td><td style='text-align: right;'>"+checkbox1+"</td></tr>";
}
event.tblpersonas=tblpersonas;



%>
 <header>
    <script type=text/javascript>
        $(function () {
            var str = '{"val": "' + '<%=event.rol%>' + '"}'; 
            var rol = jQuery.parseJSON(str);
            
            var creador = $.parseJSON('<%=event.creador%>');
            var Agenda = [];
             
            document.getElementById('myModalLabel').innerHTML = 'Actualizar Evento';
            
            $(".asistencia").change(function () {
                marcarAsistencia(this.value, this.checked)
                //alert(this.checked)
                //    if (this.checked) {
                        
                //        alert(this.checked);
                //        //Do stuff
                //    }
                });
         
            if (rol.val == 1) { 
                $('.personalTmp').attr('disabled', 'true');
                $('#tbPersonalConsulta').attr('disabled', 'true');
                
            } else {
            
                $('.personalTmp').removeAttr('disabled');
            }

            if (creador == 0) {
          
                $('.personalTmp').attr('disabled', 'true');
            } else {
                $('.personalTmp').removeAttr('disabled');
            }            

        });
        $('.verAgendaModal').click(function () {
            OpenModalAgenda();
            $("#myModalLabel2")[0].innerHTML = 'Ver punto de agenda';
            $("#tituloAgenda").attr('disabled', 'disabled');
            $('#bodyAgenda').attr('disabled', 'disabled');
            $('#editAgenda').hide();;
            $('#addAgenda').hide();
            var nosabemos = this;
            var ids = "#tbAgendaConsulta tbody " + nosabemos.id;            
            var x = document.getElementById(nosabemos.id);
            var titulo = x.innerHTML;
            var descripcion = x.title;
            $("#tituloAgenda").val(titulo);
            $('#bodyAgenda').val(descripcion);

        });
        
    </script>

</header>
<body>
    <div class="pull-left">
        <label id="idEvento" value="<%= event.id %>"><%= event.title %> </label>
    </div>
    <div id="event-meta" class="col-xs-12 col-sm-12"  style="text-align: right;">
        
        <span>Inicia el <%= event.date_start.getDate() %> <%= calendar.locale["m" + event.date_start.getMonth()] %> <%= event.date_start.getFullYear() %> a las <%= event.hourini %>:<%= event.minini %> <i class="icon-time"></i></span><br />
        <span>Finaliza el <%= event.date_end.getDate() %> <%= calendar.locale["m" + event.date_end.getMonth()] %> <%= event.date_end.getFullYear() %> a las <%= event.hourfin %>:<%= event.minfin %><i class="icon-time"></i></span><br />
 
        
         
    </div>
    <br />
    <br /><br /><br />
    <br />


    <div class="alert alert" style="background-color:lightgray">
        <label for="tipo">Detalle</label>
       <br />
        <%= event.detalle %>
    </div>
    
    <div class="alert alert-info">
        <label for="tipo">Areas y Entidades</label> <br />
        <div class="scrollbar2 scrollbar-success">
            <div class="force-overflow">
                <div class="table-responsive">
                    <div class="col-md-6">
                        <table class="table table-sm table-hover tbAreas" id="tbAreas">
                            <thead class="thead-default">
                            </thead>

                            <tbody id="tbodyAreas"></tbody>
                            <%= event.tblareas %>
                        </table>
                    </div>
                    <div class="col-md-6">
                        <table class="table table-sm table-hover tbEntidades" id="tbEntidades">
                            <thead class="thead-default">
                            </thead>

                            <tbody id="tbodyEntidades"></tbody>
                            <%= event.tblentidades %>
                        </table>
                    </div>
                </div>
            </div>

        </div>
    </div>
    <div class="alert alert-success">
        <label for="tipo">Participandes</label> <br />
        <div class="scrollbar2 scrollbar-success">
            <div class="force-overflow">
                <div class="table-responsive personalTmp">
                    <table class="table table-sm table-hover tbPersonalConsulta" id="tbPersonalConsulta">
                        <thead class="thead-default">
                        </thead>

                        <tbody id="tbodyPersonalConsulta"></tbody>
                        <%= event.tblpersonas %>
                    </table>
                </div>
            </div>

        </div>
    </div>
  
    <div class="alert alert-warning">
        <label for="tipo">Agenda</label> <br />
        <div class="scrollbar2 scrollbar-success">
            <div class="force-overflow">
                <div class="table-responsive">
                    <table class="table table-sm table-hover tbAgendaConsulta" id="tbAgendaConsulta">
                        <thead class="thead-default">
                        </thead>

                        <tbody id="tbodyAgendaConsulta"></tbody>
                        <%= event.tabla %>
                    </table>
                </div>
            </div>

        </div>
    </div>
 
        
  
</body>

